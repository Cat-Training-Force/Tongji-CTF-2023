## 天狗的流密码2

天才密码学少女「天狗」终于意识到seed的重要性，所以她这次决定增强seed的安全性，在她看来，seed就是她的对称密钥，不知道seed的人根本解不出来！下面是她用于加密flag的脚本，在加密flag之前她还尝试加密了上一次的`flag.png.encrypted`，效果很不错！

```python
from random import seed, randbytes
from secrets import token_hex

SEED = token_hex()
print(SEED)
seed(SEED)

def encrypt(b: bytes) -> bytes:
    assert len(b) % 4 == 0
    e = []
    for i in range(len(b) // 4):
        key = randbytes(4)
        for p, k in zip(b[i*4:i*4+4], key):
            e.append(p ^ k)
    return bytes(e)

test = open("./flag.png.encrypted", "rb").read()
test = test.ljust((len(test) // 4 + 1) * 4, b"\x00")
open("./flag.png.encrypted.encrypted", "wb").write(encrypt(test))

flag = open("./flag.png", "rb").read()
flag = flag.ljust((len(flag) // 4 + 1) * 4, b"\x00")
open("./flag.png.encrypted2", "wb").write(encrypt(flag))
```

